---
title: "Final Report"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Background
Climate change is very prevalent today and affects every inhabited region in the world. Evidence of climate change is shown by rising sea levels, increased extreme weather, and warmer surface and ocean temperatures. Regarding global surface temperatures, NOAA’s 2021 Annual Climate Report states that they increase annually and are projected to continue increasing. Due to the uneven naturs of warming, average temperatures will reflect the average global temperature, not the temperature in a specific geographic location. We wnat to be able to visualize and communicate data that we have gathered to various stakeholders. 

Our final project aims to increase the ease of investigators to access data and statistical methods. We have created an app that allows people to visualize the change in average temperature historically, as well as the predicted temperature changes for that country out 5 years.

# Data

The data are collected from UC-Berkley’s climate lab, spanning 1750-2013. It is publicly available on Kaggle under "Climate Change: Earth Surface Temperature Data". Specifically, we are utilizing the Global Land Temperatures By City (GlobalLandTemperaturesByCity.csv) file. The variables of interest are Average Temperature, Latitude, Longitude, City, Country, and Date. In the 1980's, Average Temperature started being measured by a digital thermometer which may make recent measurements more accurate, but reflect a cooling bias relative to older measures.

### Data preview:

```{r, include=FALSE}
library(tidyverse)
library(data.table)
setwd("/home/gtiernon/biostat625/project")
env_data <- fread("GlobalLandTemperaturesByCity.csv", showProgress = F) %>%
  select(-V1) %>%
  na.omit()
```

```{r}
head(env_data)
dim(env_data)
```

# Research Aim

Our goal is to communicate time series forecasting of global surface temperatures to policy makers, or curious citizens, through interactive visualizations on a user-friendly Shiny application. 

# Analysis

### How we built the App

We started with a skeleton of the side bar and tab panels. We used various selection options in R shiny to add graphical options for the user, including selectInput(), checkboxGroupInput(), sliderInput(), etc... We populated selectinput with countries and cities, where the cities reactively changed based on the country selected. Many conditional panels were used to show/hide options based on the specific graph the user wanted to play with. Dates were controlled with the sliderInput() and certain graphical options like stratification and lowess line were managed by checkboxGroupInput(). There were 3 main tabs all corresponding to different ways of looking at the data: by country, by city or by predictive forecasting. The main panel graphs were made using ggplot and shown based on the tab the user selected. Custom graph options included lowess lines, x axis angle, year/month ranges and stratification of country by city. The download button was made using downloadHandler() and using last_plot() in the content argument. User can choose between PDF and PNG through a reactive statement based on a radiobutton. That reactive then takes on a pdf or png value and is called withing downloadHandler as well to specify type of download. Filename was also set to the date for easy searching for the user. Lastly, bindCache was used to improve the performance of the app over time as many more users interact with the app by caching inputs and reactives once they are accessed once and grabbing them again when needed instead of reloading those inputs all over again.

### ARIMA

To make predictions about future temperature trends, we utilized the ARIMA (AutoRegressive Integrated Moving Average) model which is a statistical method for time series forecasting. In the R package 'forecast', we utilized the auto.arima() function, which returns the best ARIMA model according to either AIC or BIC values. We then forecasted this model with the forecast() function. [Abby you can make amend this]

### Big Data Application

When handling 'Big Data', computational efficiency is key for faster loading times. When coding the app, we avoided nested loops, bench marked our functions, and eliminated any necessary code to account for this. We used data.table::fread() to decrease the amount memory used and the time it takes to read the data. This cut the time it takes to launch the app in half. 

# Results

### GitHub Link

https://github.com/flynnmc15/environmental_shiny

### App link


# Contributions

Every group member utilized github to collaborate on the project.
Flynn created the GitHub repository, and built the RShiny app, including the data processing, user inputs, average temperature figures, and download features.
Abby implemented the ARIMA model, and used forecast to produce the temperature prediction figures. She also made presentation slides.
Grace wrote the Rmarkdown report and benchmark file and made presentation slides.


